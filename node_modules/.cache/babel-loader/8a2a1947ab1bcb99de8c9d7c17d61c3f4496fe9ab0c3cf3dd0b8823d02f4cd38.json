{"ast":null,"code":"import _objectSpread from \"/Users/mac/Desktop/topl1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/Users/mac/Desktop/topl1/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"address\", \"domain\", \"message\", \"nonce\", \"scheme\", \"signature\", \"time\"];\nimport { hashMessage } from '../../utils/signature/hashMessage.js';\nimport { parseSiweMessage } from '../../utils/siwe/parseSiweMessage.js';\nimport { validateSiweMessage } from '../../utils/siwe/validateSiweMessage.js';\nimport { verifyHash } from '../public/verifyHash.js';\n/**\n * Verifies [EIP-4361](https://eips.ethereum.org/EIPS/eip-4361) formatted message was signed.\n *\n * Compatible with Smart Contract Accounts & Externally Owned Accounts via [ERC-6492](https://eips.ethereum.org/EIPS/eip-6492).\n *\n * - Docs {@link https://viem.sh/docs/siwe/actions/verifySiweMessage}\n *\n * @param client - Client to use.\n * @param parameters - {@link VerifySiweMessageParameters}\n * @returns Whether or not the signature is valid. {@link VerifySiweMessageReturnType}\n */\nexport async function verifySiweMessage(client, parameters) {\n  const {\n      address,\n      domain,\n      message,\n      nonce,\n      scheme,\n      signature,\n      time = new Date()\n    } = parameters,\n    callRequest = _objectWithoutProperties(parameters, _excluded);\n  const parsed = parseSiweMessage(message);\n  if (!parsed.address) return false;\n  const isValid = validateSiweMessage({\n    address,\n    domain,\n    message: parsed,\n    nonce,\n    scheme,\n    time\n  });\n  if (!isValid) return false;\n  const hash = hashMessage(message);\n  return verifyHash(client, _objectSpread({\n    address: parsed.address,\n    hash,\n    signature\n  }, callRequest));\n}","map":{"version":3,"names":["hashMessage","parseSiweMessage","validateSiweMessage","verifyHash","verifySiweMessage","client","parameters","address","domain","message","nonce","scheme","signature","time","Date","callRequest","_objectWithoutProperties","_excluded","parsed","isValid","hash","_objectSpread"],"sources":["/Users/mac/Desktop/topl1/frontend/node_modules/viem/actions/siwe/verifySiweMessage.ts"],"sourcesContent":["import type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport type { ErrorType } from '../../errors/utils.js'\nimport type { Chain } from '../../types/chain.js'\nimport type { Hex } from '../../types/misc.js'\nimport type { Prettify } from '../../types/utils.js'\nimport type { HashMessageErrorType } from '../../utils/signature/hashMessage.js'\nimport { hashMessage } from '../../utils/signature/hashMessage.js'\nimport { parseSiweMessage } from '../../utils/siwe/parseSiweMessage.js'\nimport {\n  type ValidateSiweMessageParameters,\n  validateSiweMessage,\n} from '../../utils/siwe/validateSiweMessage.js'\nimport {\n  type VerifyHashErrorType,\n  type VerifyHashParameters,\n  verifyHash,\n} from '../public/verifyHash.js'\n\nexport type VerifySiweMessageParameters = Prettify<\n  Pick<VerifyHashParameters, 'blockNumber' | 'blockTag'> &\n    Pick<\n      ValidateSiweMessageParameters,\n      'address' | 'domain' | 'nonce' | 'scheme' | 'time'\n    > & {\n      /**\n       * EIP-4361 formatted message.\n       */\n      message: string\n      /**\n       * Signature to check against.\n       */\n      signature: Hex\n    }\n>\n\nexport type VerifySiweMessageReturnType = boolean\n\nexport type VerifySiweMessageErrorType =\n  | HashMessageErrorType\n  | VerifyHashErrorType\n  | ErrorType\n\n/**\n * Verifies [EIP-4361](https://eips.ethereum.org/EIPS/eip-4361) formatted message was signed.\n *\n * Compatible with Smart Contract Accounts & Externally Owned Accounts via [ERC-6492](https://eips.ethereum.org/EIPS/eip-6492).\n *\n * - Docs {@link https://viem.sh/docs/siwe/actions/verifySiweMessage}\n *\n * @param client - Client to use.\n * @param parameters - {@link VerifySiweMessageParameters}\n * @returns Whether or not the signature is valid. {@link VerifySiweMessageReturnType}\n */\nexport async function verifySiweMessage<chain extends Chain | undefined>(\n  client: Client<Transport, chain>,\n  parameters: VerifySiweMessageParameters,\n): Promise<VerifySiweMessageReturnType> {\n  const {\n    address,\n    domain,\n    message,\n    nonce,\n    scheme,\n    signature,\n    time = new Date(),\n    ...callRequest\n  } = parameters\n\n  const parsed = parseSiweMessage(message)\n  if (!parsed.address) return false\n\n  const isValid = validateSiweMessage({\n    address,\n    domain,\n    message: parsed,\n    nonce,\n    scheme,\n    time,\n  })\n  if (!isValid) return false\n\n  const hash = hashMessage(message)\n  return verifyHash(client, {\n    address: parsed.address,\n    hash,\n    signature,\n    ...callRequest,\n  })\n}\n"],"mappings":";;;AAOA,SAASA,WAAW,QAAQ,sCAAsC;AAClE,SAASC,gBAAgB,QAAQ,sCAAsC;AACvE,SAEEC,mBAAmB,QACd,yCAAyC;AAChD,SAGEC,UAAU,QACL,yBAAyB;AA0BhC;;;;;;;;;;;AAWA,OAAO,eAAeC,iBAAiBA,CACrCC,MAAgC,EAChCC,UAAuC;EAEvC,MAAM;MACJC,OAAO;MACPC,MAAM;MACNC,OAAO;MACPC,KAAK;MACLC,MAAM;MACNC,SAAS;MACTC,IAAI,GAAG,IAAIC,IAAI;IACD,CACf,GAAGR,UAAU;IADTS,WAAW,GAAAC,wBAAA,CACZV,UAAU,EAAAW,SAAA;EAEd,MAAMC,MAAM,GAAGjB,gBAAgB,CAACQ,OAAO,CAAC;EACxC,IAAI,CAACS,MAAM,CAACX,OAAO,EAAE,OAAO,KAAK;EAEjC,MAAMY,OAAO,GAAGjB,mBAAmB,CAAC;IAClCK,OAAO;IACPC,MAAM;IACNC,OAAO,EAAES,MAAM;IACfR,KAAK;IACLC,MAAM;IACNE;GACD,CAAC;EACF,IAAI,CAACM,OAAO,EAAE,OAAO,KAAK;EAE1B,MAAMC,IAAI,GAAGpB,WAAW,CAACS,OAAO,CAAC;EACjC,OAAON,UAAU,CAACE,MAAM,EAAAgB,aAAA;IACtBd,OAAO,EAAEW,MAAM,CAACX,OAAO;IACvBa,IAAI;IACJR;EAAS,GACNG,WAAW,CACf,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}