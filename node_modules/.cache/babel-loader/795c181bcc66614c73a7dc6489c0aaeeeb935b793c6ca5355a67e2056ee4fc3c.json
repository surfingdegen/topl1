{"ast":null,"code":"import { errorValues, standardErrorCodes } from './constants.js';\nconst FALLBACK_MESSAGE = 'Unspecified error message.';\nexport const JSON_RPC_SERVER_ERROR_MESSAGE = 'Unspecified server error.';\n/**\n * Gets the message for a given code, or a fallback message if the code has\n * no corresponding message.\n */\nexport function getMessageFromCode(code) {\n  let fallbackMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : FALLBACK_MESSAGE;\n  if (code && Number.isInteger(code)) {\n    const codeString = code.toString();\n    if (hasKey(errorValues, codeString)) {\n      return errorValues[codeString].message;\n    }\n    if (isJsonRpcServerError(code)) {\n      return JSON_RPC_SERVER_ERROR_MESSAGE;\n    }\n  }\n  return fallbackMessage;\n}\n/**\n * Returns whether the given code is valid.\n * A code is only valid if it has a message.\n */\nexport function isValidCode(code) {\n  if (!Number.isInteger(code)) {\n    return false;\n  }\n  const codeString = code.toString();\n  if (errorValues[codeString]) {\n    return true;\n  }\n  if (isJsonRpcServerError(code)) {\n    return true;\n  }\n  return false;\n}\n/**\n * Returns the error code from an error object.\n */\nexport function getErrorCode(error) {\n  var _a;\n  if (typeof error === 'number') {\n    return error;\n  } else if (isErrorWithCode(error)) {\n    return (_a = error.code) !== null && _a !== void 0 ? _a : error.errorCode;\n  }\n  return undefined;\n}\nfunction isErrorWithCode(error) {\n  return typeof error === 'object' && error !== null && (typeof error.code === 'number' || typeof error.errorCode === 'number');\n}\nexport function serialize(error) {\n  let {\n    shouldIncludeStack = false\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const serialized = {};\n  if (error && typeof error === 'object' && !Array.isArray(error) && hasKey(error, 'code') && isValidCode(error.code)) {\n    const _error = error;\n    serialized.code = _error.code;\n    if (_error.message && typeof _error.message === 'string') {\n      serialized.message = _error.message;\n      if (hasKey(_error, 'data')) {\n        serialized.data = _error.data;\n      }\n    } else {\n      serialized.message = getMessageFromCode(serialized.code);\n      serialized.data = {\n        originalError: assignOriginalError(error)\n      };\n    }\n  } else {\n    serialized.code = standardErrorCodes.rpc.internal;\n    serialized.message = hasStringProperty(error, 'message') ? error.message : FALLBACK_MESSAGE;\n    serialized.data = {\n      originalError: assignOriginalError(error)\n    };\n  }\n  if (shouldIncludeStack) {\n    serialized.stack = hasStringProperty(error, 'stack') ? error.stack : undefined;\n  }\n  return serialized;\n}\n// Internal\nfunction isJsonRpcServerError(code) {\n  return code >= -32099 && code <= -32000;\n}\nfunction assignOriginalError(error) {\n  if (error && typeof error === 'object' && !Array.isArray(error)) {\n    return Object.assign({}, error);\n  }\n  return error;\n}\nfunction hasKey(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\nfunction hasStringProperty(obj, prop) {\n  return typeof obj === 'object' && obj !== null && prop in obj && typeof obj[prop] === 'string';\n}","map":{"version":3,"names":["errorValues","standardErrorCodes","FALLBACK_MESSAGE","JSON_RPC_SERVER_ERROR_MESSAGE","getMessageFromCode","code","fallbackMessage","arguments","length","undefined","Number","isInteger","codeString","toString","hasKey","message","isJsonRpcServerError","isValidCode","getErrorCode","error","isErrorWithCode","_a","errorCode","serialize","shouldIncludeStack","serialized","Array","isArray","_error","data","originalError","assignOriginalError","rpc","internal","hasStringProperty","stack","Object","assign","obj","key","prototype","hasOwnProperty","call","prop"],"sources":["../../../src/core/error/utils.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}