{"ast":null,"code":"import _objectWithoutProperties from \"/Users/mac/Desktop/topl1/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _objectSpread from \"/Users/mac/Desktop/topl1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nconst _excluded = [\"chainId\", \"from\", \"gas\", \"gasPrice\", \"nonce\", \"maxFeePerBlobGas\", \"maxFeePerGas\", \"maxPriorityFeePerGas\", \"type\"];\nimport { parseAccount } from '../../accounts/utils/parseAccount.js';\nimport { internal_estimateFeesPerGas } from '../../actions/public/estimateFeesPerGas.js';\nimport { estimateGas } from '../../actions/public/estimateGas.js';\nimport { getBlock as getBlock_ } from '../../actions/public/getBlock.js';\nimport { getTransactionCount } from '../../actions/public/getTransactionCount.js';\nimport { Eip1559FeesNotSupportedError, MaxFeePerGasTooLowError } from '../../errors/fee.js';\nimport { blobsToCommitments } from '../../utils/blob/blobsToCommitments.js';\nimport { blobsToProofs } from '../../utils/blob/blobsToProofs.js';\nimport { commitmentsToVersionedHashes } from '../../utils/blob/commitmentsToVersionedHashes.js';\nimport { toBlobSidecars } from '../../utils/blob/toBlobSidecars.js';\nimport { getAction } from '../../utils/getAction.js';\nimport { LruMap } from '../../utils/lru.js';\nimport { assertRequest } from '../../utils/transaction/assertRequest.js';\nimport { getTransactionType } from '../../utils/transaction/getTransactionType.js';\nimport { fillTransaction } from '../public/fillTransaction.js';\nimport { getChainId as getChainId_ } from '../public/getChainId.js';\nexport const defaultParameters = ['blobVersionedHashes', 'chainId', 'fees', 'gas', 'nonce', 'type'];\n/** @internal */\nexport const eip1559NetworkCache = /*#__PURE__*/new Map();\n/** @internal */\nexport const supportsFillTransaction = /*#__PURE__*/new LruMap(128);\n/**\n * Prepares a transaction request for signing.\n *\n * - Docs: https://viem.sh/docs/actions/wallet/prepareTransactionRequest\n *\n * @param args - {@link PrepareTransactionRequestParameters}\n * @returns The transaction request. {@link PrepareTransactionRequestReturnType}\n *\n * @example\n * import { createWalletClient, custom } from 'viem'\n * import { mainnet } from 'viem/chains'\n * import { prepareTransactionRequest } from 'viem/actions'\n *\n * const client = createWalletClient({\n *   chain: mainnet,\n *   transport: custom(window.ethereum),\n * })\n * const request = await prepareTransactionRequest(client, {\n *   account: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n *   to: '0x0000000000000000000000000000000000000000',\n *   value: 1n,\n * })\n *\n * @example\n * // Account Hoisting\n * import { createWalletClient, http } from 'viem'\n * import { privateKeyToAccount } from 'viem/accounts'\n * import { mainnet } from 'viem/chains'\n * import { prepareTransactionRequest } from 'viem/actions'\n *\n * const client = createWalletClient({\n *   account: privateKeyToAccount('0x…'),\n *   chain: mainnet,\n *   transport: custom(window.ethereum),\n * })\n * const request = await prepareTransactionRequest(client, {\n *   to: '0x0000000000000000000000000000000000000000',\n *   value: 1n,\n * })\n */\nexport async function prepareTransactionRequest(client, args) {\n  var _request, _request$account, _request2, _request2$parameters, _prepareTransactionRe, _prepareTransactionRe2, _prepareTransactionRe3;\n  let request = args;\n  (_request$account = (_request = request).account) !== null && _request$account !== void 0 ? _request$account : _request.account = client.account;\n  (_request2$parameters = (_request2 = request).parameters) !== null && _request2$parameters !== void 0 ? _request2$parameters : _request2.parameters = defaultParameters;\n  const {\n    account: account_,\n    chain = client.chain,\n    nonceManager,\n    parameters\n  } = request;\n  const prepareTransactionRequest = (() => {\n    if (typeof (chain === null || chain === void 0 ? void 0 : chain.prepareTransactionRequest) === 'function') return {\n      fn: chain.prepareTransactionRequest,\n      runAt: ['beforeFillTransaction']\n    };\n    if (Array.isArray(chain === null || chain === void 0 ? void 0 : chain.prepareTransactionRequest)) return {\n      fn: chain.prepareTransactionRequest[0],\n      runAt: chain.prepareTransactionRequest[1].runAt\n    };\n    return undefined;\n  })();\n  let chainId;\n  async function getChainId() {\n    if (chainId) return chainId;\n    if (typeof request.chainId !== 'undefined') return request.chainId;\n    if (chain) return chain.id;\n    const chainId_ = await getAction(client, getChainId_, 'getChainId')({});\n    chainId = chainId_;\n    return chainId;\n  }\n  const account = account_ ? parseAccount(account_) : account_;\n  let nonce = request.nonce;\n  if (parameters.includes('nonce') && typeof nonce === 'undefined' && account && nonceManager) {\n    const chainId = await getChainId();\n    nonce = await nonceManager.consume({\n      address: account.address,\n      chainId,\n      client\n    });\n  }\n  if (prepareTransactionRequest !== null && prepareTransactionRequest !== void 0 && prepareTransactionRequest.fn && (_prepareTransactionRe = prepareTransactionRequest.runAt) !== null && _prepareTransactionRe !== void 0 && _prepareTransactionRe.includes('beforeFillTransaction')) {\n    request = await prepareTransactionRequest.fn(_objectSpread(_objectSpread({}, request), {}, {\n      chain\n    }), {\n      phase: 'beforeFillTransaction'\n    });\n    nonce !== null && nonce !== void 0 ? nonce : nonce = request.nonce;\n  }\n  const attemptFill = (() => {\n    // Do not attempt if blobs are provided.\n    if ((parameters.includes('blobVersionedHashes') || parameters.includes('sidecars')) && request.kzg && request.blobs) return false;\n    // Do not attempt if `eth_fillTransaction` is not supported.\n    if (supportsFillTransaction.get(client.uid) === false) return false;\n    // Should attempt `eth_fillTransaction` if \"fees\" or \"gas\" are required to be populated,\n    // otherwise, can just use the other individual calls.\n    const shouldAttempt = ['fees', 'gas'].some(parameter => parameters.includes(parameter));\n    if (!shouldAttempt) return false;\n    // Check if `eth_fillTransaction` needs to be called.\n    if (parameters.includes('chainId') && typeof request.chainId !== 'number') return true;\n    if (parameters.includes('nonce') && typeof nonce !== 'number') return true;\n    if (parameters.includes('fees') && typeof request.gasPrice !== 'bigint' && (typeof request.maxFeePerGas !== 'bigint' || typeof request.maxPriorityFeePerGas !== 'bigint')) return true;\n    if (parameters.includes('gas') && typeof request.gas !== 'bigint') return true;\n    return false;\n  })();\n  const fillResult = attemptFill ? await getAction(client, fillTransaction, 'fillTransaction')(_objectSpread(_objectSpread({}, request), {}, {\n    nonce\n  })).then(result => {\n    const _result$transaction = result.transaction,\n      {\n        chainId,\n        from,\n        gas,\n        gasPrice,\n        nonce,\n        maxFeePerBlobGas,\n        maxFeePerGas,\n        maxPriorityFeePerGas,\n        type\n      } = _result$transaction,\n      rest = _objectWithoutProperties(_result$transaction, _excluded);\n    supportsFillTransaction.set(client.uid, true);\n    return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, request), from ? {\n      from\n    } : {}), type ? {\n      type\n    } : {}), typeof chainId !== 'undefined' ? {\n      chainId\n    } : {}), typeof gas !== 'undefined' ? {\n      gas\n    } : {}), typeof gasPrice !== 'undefined' ? {\n      gasPrice\n    } : {}), typeof nonce !== 'undefined' ? {\n      nonce\n    } : {}), typeof maxFeePerBlobGas !== 'undefined' ? {\n      maxFeePerBlobGas\n    } : {}), typeof maxFeePerGas !== 'undefined' ? {\n      maxFeePerGas\n    } : {}), typeof maxPriorityFeePerGas !== 'undefined' ? {\n      maxPriorityFeePerGas\n    } : {}), 'nonceKey' in rest && typeof rest.nonceKey !== 'undefined' ? {\n      nonceKey: rest.nonceKey\n    } : {});\n  }).catch(e => {\n    var _error$walk;\n    const error = e;\n    if (error.name !== 'TransactionExecutionError') return request;\n    const unsupported = (_error$walk = error.walk) === null || _error$walk === void 0 ? void 0 : _error$walk.call(error, e => {\n      const error = e;\n      return error.name === 'MethodNotFoundRpcError' || error.name === 'MethodNotSupportedRpcError';\n    });\n    if (unsupported) supportsFillTransaction.set(client.uid, false);\n    return request;\n  }) : request;\n  nonce !== null && nonce !== void 0 ? nonce : nonce = fillResult.nonce;\n  request = _objectSpread(_objectSpread(_objectSpread({}, fillResult), account ? {\n    from: account === null || account === void 0 ? void 0 : account.address\n  } : {}), nonce ? {\n    nonce\n  } : {});\n  const {\n    blobs,\n    gas,\n    kzg,\n    type\n  } = request;\n  if (prepareTransactionRequest !== null && prepareTransactionRequest !== void 0 && prepareTransactionRequest.fn && (_prepareTransactionRe2 = prepareTransactionRequest.runAt) !== null && _prepareTransactionRe2 !== void 0 && _prepareTransactionRe2.includes('beforeFillParameters')) {\n    request = await prepareTransactionRequest.fn(_objectSpread(_objectSpread({}, request), {}, {\n      chain\n    }), {\n      phase: 'beforeFillParameters'\n    });\n  }\n  let block;\n  async function getBlock() {\n    if (block) return block;\n    block = await getAction(client, getBlock_, 'getBlock')({\n      blockTag: 'latest'\n    });\n    return block;\n  }\n  if (parameters.includes('nonce') && typeof nonce === 'undefined' && account && !nonceManager) request.nonce = await getAction(client, getTransactionCount, 'getTransactionCount')({\n    address: account.address,\n    blockTag: 'pending'\n  });\n  if ((parameters.includes('blobVersionedHashes') || parameters.includes('sidecars')) && blobs && kzg) {\n    const commitments = blobsToCommitments({\n      blobs,\n      kzg\n    });\n    if (parameters.includes('blobVersionedHashes')) {\n      const versionedHashes = commitmentsToVersionedHashes({\n        commitments,\n        to: 'hex'\n      });\n      request.blobVersionedHashes = versionedHashes;\n    }\n    if (parameters.includes('sidecars')) {\n      const proofs = blobsToProofs({\n        blobs,\n        commitments,\n        kzg\n      });\n      const sidecars = toBlobSidecars({\n        blobs,\n        commitments,\n        proofs,\n        to: 'hex'\n      });\n      request.sidecars = sidecars;\n    }\n  }\n  if (parameters.includes('chainId')) request.chainId = await getChainId();\n  if ((parameters.includes('fees') || parameters.includes('type')) && typeof type === 'undefined') {\n    try {\n      request.type = getTransactionType(request);\n    } catch (_unused) {\n      let isEip1559Network = eip1559NetworkCache.get(client.uid);\n      if (typeof isEip1559Network === 'undefined') {\n        const block = await getBlock();\n        isEip1559Network = typeof (block === null || block === void 0 ? void 0 : block.baseFeePerGas) === 'bigint';\n        eip1559NetworkCache.set(client.uid, isEip1559Network);\n      }\n      request.type = isEip1559Network ? 'eip1559' : 'legacy';\n    }\n  }\n  if (parameters.includes('fees')) {\n    // TODO(4844): derive blob base fees once https://github.com/ethereum/execution-apis/pull/486 is merged.\n    if (request.type !== 'legacy' && request.type !== 'eip2930') {\n      // EIP-1559 fees\n      if (typeof request.maxFeePerGas === 'undefined' || typeof request.maxPriorityFeePerGas === 'undefined') {\n        const block = await getBlock();\n        const {\n          maxFeePerGas,\n          maxPriorityFeePerGas\n        } = await internal_estimateFeesPerGas(client, {\n          block: block,\n          chain,\n          request: request\n        });\n        if (typeof request.maxPriorityFeePerGas === 'undefined' && request.maxFeePerGas && request.maxFeePerGas < maxPriorityFeePerGas) throw new MaxFeePerGasTooLowError({\n          maxPriorityFeePerGas\n        });\n        request.maxPriorityFeePerGas = maxPriorityFeePerGas;\n        request.maxFeePerGas = maxFeePerGas;\n      }\n    } else {\n      // Legacy fees\n      if (typeof request.maxFeePerGas !== 'undefined' || typeof request.maxPriorityFeePerGas !== 'undefined') throw new Eip1559FeesNotSupportedError();\n      if (typeof request.gasPrice === 'undefined') {\n        const block = await getBlock();\n        const {\n          gasPrice: gasPrice_\n        } = await internal_estimateFeesPerGas(client, {\n          block: block,\n          chain,\n          request: request,\n          type: 'legacy'\n        });\n        request.gasPrice = gasPrice_;\n      }\n    }\n  }\n  if (parameters.includes('gas') && typeof gas === 'undefined') request.gas = await getAction(client, estimateGas, 'estimateGas')(_objectSpread(_objectSpread({}, request), {}, {\n    account,\n    prepare: (account === null || account === void 0 ? void 0 : account.type) === 'local' ? [] : ['blobVersionedHashes']\n  }));\n  if (prepareTransactionRequest !== null && prepareTransactionRequest !== void 0 && prepareTransactionRequest.fn && (_prepareTransactionRe3 = prepareTransactionRequest.runAt) !== null && _prepareTransactionRe3 !== void 0 && _prepareTransactionRe3.includes('afterFillParameters')) request = await prepareTransactionRequest.fn(_objectSpread(_objectSpread({}, request), {}, {\n    chain\n  }), {\n    phase: 'afterFillParameters'\n  });\n  assertRequest(request);\n  delete request.parameters;\n  return request;\n}","map":{"version":3,"names":["parseAccount","internal_estimateFeesPerGas","estimateGas","getBlock","getBlock_","getTransactionCount","Eip1559FeesNotSupportedError","MaxFeePerGasTooLowError","blobsToCommitments","blobsToProofs","commitmentsToVersionedHashes","toBlobSidecars","getAction","LruMap","assertRequest","getTransactionType","fillTransaction","getChainId","getChainId_","defaultParameters","eip1559NetworkCache","Map","supportsFillTransaction","prepareTransactionRequest","client","args","_request","_request$account","_request2","_request2$parameters","_prepareTransactionRe","_prepareTransactionRe2","_prepareTransactionRe3","request","account","parameters","account_","chain","nonceManager","fn","runAt","Array","isArray","undefined","chainId","id","chainId_","nonce","includes","consume","address","_objectSpread","phase","attemptFill","kzg","blobs","get","uid","shouldAttempt","some","parameter","gasPrice","maxFeePerGas","maxPriorityFeePerGas","gas","fillResult","then","result","_result$transaction","transaction","from","maxFeePerBlobGas","type","rest","_objectWithoutProperties","_excluded","set","nonceKey","catch","e","_error$walk","error","name","unsupported","walk","call","block","blockTag","commitments","versionedHashes","to","blobVersionedHashes","proofs","sidecars","_unused","isEip1559Network","baseFeePerGas","gasPrice_","prepare"],"sources":["/Users/mac/Desktop/topl1/frontend/node_modules/viem/actions/wallet/prepareTransactionRequest.ts"],"sourcesContent":["import type { Address } from 'abitype'\nimport type { Account } from '../../accounts/types.js'\nimport {\n  type ParseAccountErrorType,\n  parseAccount,\n} from '../../accounts/utils/parseAccount.js'\nimport {\n  type EstimateFeesPerGasErrorType,\n  internal_estimateFeesPerGas,\n} from '../../actions/public/estimateFeesPerGas.js'\nimport {\n  type EstimateGasErrorType,\n  type EstimateGasParameters,\n  estimateGas,\n} from '../../actions/public/estimateGas.js'\nimport {\n  type GetBlockErrorType,\n  getBlock as getBlock_,\n} from '../../actions/public/getBlock.js'\nimport {\n  type GetTransactionCountErrorType,\n  getTransactionCount,\n} from '../../actions/public/getTransactionCount.js'\nimport type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport type { AccountNotFoundErrorType } from '../../errors/account.js'\nimport type { BaseError } from '../../errors/base.js'\nimport {\n  Eip1559FeesNotSupportedError,\n  MaxFeePerGasTooLowError,\n} from '../../errors/fee.js'\nimport type { DeriveAccount, GetAccountParameter } from '../../types/account.js'\nimport type { Block } from '../../types/block.js'\nimport type {\n  Chain,\n  DeriveChain,\n  GetChainParameter,\n} from '../../types/chain.js'\nimport type { GetTransactionRequestKzgParameter } from '../../types/kzg.js'\nimport type {\n  TransactionRequest,\n  TransactionRequestEIP1559,\n  TransactionRequestEIP2930,\n  TransactionRequestEIP4844,\n  TransactionRequestEIP7702,\n  TransactionRequestLegacy,\n  TransactionSerializable,\n} from '../../types/transaction.js'\nimport type {\n  ExactPartial,\n  IsNever,\n  Prettify,\n  UnionOmit,\n  UnionRequiredBy,\n} from '../../types/utils.js'\nimport { blobsToCommitments } from '../../utils/blob/blobsToCommitments.js'\nimport { blobsToProofs } from '../../utils/blob/blobsToProofs.js'\nimport { commitmentsToVersionedHashes } from '../../utils/blob/commitmentsToVersionedHashes.js'\nimport { toBlobSidecars } from '../../utils/blob/toBlobSidecars.js'\nimport type { FormattedTransactionRequest } from '../../utils/formatters/transactionRequest.js'\nimport { getAction } from '../../utils/getAction.js'\nimport { LruMap } from '../../utils/lru.js'\nimport type { NonceManager } from '../../utils/nonceManager.js'\nimport {\n  type AssertRequestErrorType,\n  type AssertRequestParameters,\n  assertRequest,\n} from '../../utils/transaction/assertRequest.js'\nimport {\n  type GetTransactionType,\n  getTransactionType,\n} from '../../utils/transaction/getTransactionType.js'\nimport {\n  type FillTransactionErrorType,\n  type FillTransactionParameters,\n  fillTransaction,\n} from '../public/fillTransaction.js'\nimport { getChainId as getChainId_ } from '../public/getChainId.js'\n\nexport const defaultParameters = [\n  'blobVersionedHashes',\n  'chainId',\n  'fees',\n  'gas',\n  'nonce',\n  'type',\n] as const\n\n/** @internal */\nexport const eip1559NetworkCache = /*#__PURE__*/ new Map<string, boolean>()\n\n/** @internal */\nexport const supportsFillTransaction = /*#__PURE__*/ new LruMap<boolean>(128)\n\nexport type PrepareTransactionRequestParameterType =\n  | 'blobVersionedHashes'\n  | 'chainId'\n  | 'fees'\n  | 'gas'\n  | 'nonce'\n  | 'sidecars'\n  | 'type'\ntype ParameterTypeToParameters<\n  parameterType extends PrepareTransactionRequestParameterType,\n> = parameterType extends 'fees'\n  ? 'maxFeePerGas' | 'maxPriorityFeePerGas' | 'gasPrice'\n  : parameterType\n\nexport type PrepareTransactionRequestRequest<\n  chain extends Chain | undefined = Chain | undefined,\n  chainOverride extends Chain | undefined = Chain | undefined,\n  ///\n  _derivedChain extends Chain | undefined = DeriveChain<chain, chainOverride>,\n> = UnionOmit<FormattedTransactionRequest<_derivedChain>, 'from'> &\n  GetTransactionRequestKzgParameter & {\n    /**\n     * Nonce manager to use for the transaction request.\n     */\n    nonceManager?: NonceManager | undefined\n    /**\n     * Parameters to prepare for the transaction request.\n     *\n     * @default ['blobVersionedHashes', 'chainId', 'fees', 'gas', 'nonce', 'type']\n     */\n    parameters?: readonly PrepareTransactionRequestParameterType[] | undefined\n  }\n\nexport type PrepareTransactionRequestParameters<\n  chain extends Chain | undefined = Chain | undefined,\n  account extends Account | undefined = Account | undefined,\n  chainOverride extends Chain | undefined = Chain | undefined,\n  accountOverride extends Account | Address | undefined =\n    | Account\n    | Address\n    | undefined,\n  request extends PrepareTransactionRequestRequest<\n    chain,\n    chainOverride\n  > = PrepareTransactionRequestRequest<chain, chainOverride>,\n> = request &\n  GetAccountParameter<account, accountOverride, false, true> &\n  GetChainParameter<chain, chainOverride> &\n  GetTransactionRequestKzgParameter<request> & { chainId?: number | undefined }\n\nexport type PrepareTransactionRequestReturnType<\n  chain extends Chain | undefined = Chain | undefined,\n  account extends Account | undefined = Account | undefined,\n  chainOverride extends Chain | undefined = Chain | undefined,\n  accountOverride extends Account | Address | undefined =\n    | Account\n    | Address\n    | undefined,\n  request extends PrepareTransactionRequestRequest<\n    chain,\n    chainOverride\n  > = PrepareTransactionRequestRequest<chain, chainOverride>,\n  ///\n  _derivedAccount extends Account | Address | undefined = DeriveAccount<\n    account,\n    accountOverride\n  >,\n  _derivedChain extends Chain | undefined = DeriveChain<chain, chainOverride>,\n  _transactionType = request['type'] extends string | undefined\n    ? request['type']\n    : GetTransactionType<request> extends 'legacy'\n      ? unknown\n      : GetTransactionType<request>,\n  _transactionRequest extends TransactionRequest =\n    | (_transactionType extends 'legacy' ? TransactionRequestLegacy : never)\n    | (_transactionType extends 'eip1559' ? TransactionRequestEIP1559 : never)\n    | (_transactionType extends 'eip2930' ? TransactionRequestEIP2930 : never)\n    | (_transactionType extends 'eip4844' ? TransactionRequestEIP4844 : never)\n    | (_transactionType extends 'eip7702' ? TransactionRequestEIP7702 : never),\n> = Prettify<\n  UnionRequiredBy<\n    Extract<\n      UnionOmit<FormattedTransactionRequest<_derivedChain>, 'from'> &\n        (_derivedChain extends Chain\n          ? { chain: _derivedChain }\n          : { chain?: undefined }) &\n        (_derivedAccount extends Account\n          ? { account: _derivedAccount; from: Address }\n          : { account?: undefined; from?: undefined }),\n      IsNever<_transactionRequest> extends true\n        ? unknown\n        : ExactPartial<_transactionRequest>\n    > & { chainId?: number | undefined },\n    ParameterTypeToParameters<\n      request['parameters'] extends readonly PrepareTransactionRequestParameterType[]\n        ? request['parameters'][number]\n        : (typeof defaultParameters)[number]\n    >\n  > &\n    (unknown extends request['kzg'] ? {} : Pick<request, 'kzg'>)\n>\n\nexport type PrepareTransactionRequestErrorType =\n  | AccountNotFoundErrorType\n  | AssertRequestErrorType\n  | ParseAccountErrorType\n  | GetBlockErrorType\n  | GetTransactionCountErrorType\n  | EstimateGasErrorType\n  | EstimateFeesPerGasErrorType\n\n/**\n * Prepares a transaction request for signing.\n *\n * - Docs: https://viem.sh/docs/actions/wallet/prepareTransactionRequest\n *\n * @param args - {@link PrepareTransactionRequestParameters}\n * @returns The transaction request. {@link PrepareTransactionRequestReturnType}\n *\n * @example\n * import { createWalletClient, custom } from 'viem'\n * import { mainnet } from 'viem/chains'\n * import { prepareTransactionRequest } from 'viem/actions'\n *\n * const client = createWalletClient({\n *   chain: mainnet,\n *   transport: custom(window.ethereum),\n * })\n * const request = await prepareTransactionRequest(client, {\n *   account: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n *   to: '0x0000000000000000000000000000000000000000',\n *   value: 1n,\n * })\n *\n * @example\n * // Account Hoisting\n * import { createWalletClient, http } from 'viem'\n * import { privateKeyToAccount } from 'viem/accounts'\n * import { mainnet } from 'viem/chains'\n * import { prepareTransactionRequest } from 'viem/actions'\n *\n * const client = createWalletClient({\n *   account: privateKeyToAccount('0x…'),\n *   chain: mainnet,\n *   transport: custom(window.ethereum),\n * })\n * const request = await prepareTransactionRequest(client, {\n *   to: '0x0000000000000000000000000000000000000000',\n *   value: 1n,\n * })\n */\nexport async function prepareTransactionRequest<\n  chain extends Chain | undefined,\n  account extends Account | undefined,\n  const request extends PrepareTransactionRequestRequest<chain, chainOverride>,\n  accountOverride extends Account | Address | undefined = undefined,\n  chainOverride extends Chain | undefined = undefined,\n>(\n  client: Client<Transport, chain, account>,\n  args: PrepareTransactionRequestParameters<\n    chain,\n    account,\n    chainOverride,\n    accountOverride,\n    request\n  >,\n): Promise<\n  PrepareTransactionRequestReturnType<\n    chain,\n    account,\n    chainOverride,\n    accountOverride,\n    request\n  >\n> {\n  let request = args as PrepareTransactionRequestParameters\n\n  request.account ??= client.account\n  request.parameters ??= defaultParameters\n\n  const {\n    account: account_,\n    chain = client.chain,\n    nonceManager,\n    parameters,\n  } = request\n\n  const prepareTransactionRequest = (() => {\n    if (typeof chain?.prepareTransactionRequest === 'function')\n      return {\n        fn: chain.prepareTransactionRequest,\n        runAt: ['beforeFillTransaction'],\n      }\n    if (Array.isArray(chain?.prepareTransactionRequest))\n      return {\n        fn: chain.prepareTransactionRequest[0],\n        runAt: chain.prepareTransactionRequest[1].runAt,\n      }\n    return undefined\n  })()\n\n  let chainId: number | undefined\n  async function getChainId(): Promise<number> {\n    if (chainId) return chainId\n    if (typeof request.chainId !== 'undefined') return request.chainId\n    if (chain) return chain.id\n    const chainId_ = await getAction(client, getChainId_, 'getChainId')({})\n    chainId = chainId_\n    return chainId\n  }\n\n  const account = account_ ? parseAccount(account_) : account_\n\n  let nonce = request.nonce\n  if (\n    parameters.includes('nonce') &&\n    typeof nonce === 'undefined' &&\n    account &&\n    nonceManager\n  ) {\n    const chainId = await getChainId()\n    nonce = await nonceManager.consume({\n      address: account.address,\n      chainId,\n      client,\n    })\n  }\n\n  if (\n    prepareTransactionRequest?.fn &&\n    prepareTransactionRequest.runAt?.includes('beforeFillTransaction')\n  ) {\n    request = await prepareTransactionRequest.fn(\n      { ...request, chain },\n      {\n        phase: 'beforeFillTransaction',\n      },\n    )\n    nonce ??= request.nonce\n  }\n\n  const attemptFill = (() => {\n    // Do not attempt if blobs are provided.\n    if (\n      (parameters.includes('blobVersionedHashes') ||\n        parameters.includes('sidecars')) &&\n      request.kzg &&\n      request.blobs\n    )\n      return false\n\n    // Do not attempt if `eth_fillTransaction` is not supported.\n    if (supportsFillTransaction.get(client.uid) === false) return false\n\n    // Should attempt `eth_fillTransaction` if \"fees\" or \"gas\" are required to be populated,\n    // otherwise, can just use the other individual calls.\n    const shouldAttempt = ['fees', 'gas'].some((parameter) =>\n      parameters.includes(parameter as PrepareTransactionRequestParameterType),\n    )\n    if (!shouldAttempt) return false\n\n    // Check if `eth_fillTransaction` needs to be called.\n    if (parameters.includes('chainId') && typeof request.chainId !== 'number')\n      return true\n    if (parameters.includes('nonce') && typeof nonce !== 'number') return true\n    if (\n      parameters.includes('fees') &&\n      typeof request.gasPrice !== 'bigint' &&\n      (typeof request.maxFeePerGas !== 'bigint' ||\n        typeof (request as any).maxPriorityFeePerGas !== 'bigint')\n    )\n      return true\n    if (parameters.includes('gas') && typeof request.gas !== 'bigint')\n      return true\n    return false\n  })()\n\n  const fillResult = attemptFill\n    ? await getAction(\n        client,\n        fillTransaction,\n        'fillTransaction',\n      )({ ...request, nonce } as FillTransactionParameters)\n        .then((result) => {\n          const {\n            chainId,\n            from,\n            gas,\n            gasPrice,\n            nonce,\n            maxFeePerBlobGas,\n            maxFeePerGas,\n            maxPriorityFeePerGas,\n            type,\n            ...rest\n          } = result.transaction\n          supportsFillTransaction.set(client.uid, true)\n          return {\n            ...request,\n            ...(from ? { from } : {}),\n            ...(type ? { type } : {}),\n            ...(typeof chainId !== 'undefined' ? { chainId } : {}),\n            ...(typeof gas !== 'undefined' ? { gas } : {}),\n            ...(typeof gasPrice !== 'undefined' ? { gasPrice } : {}),\n            ...(typeof nonce !== 'undefined' ? { nonce } : {}),\n            ...(typeof maxFeePerBlobGas !== 'undefined'\n              ? { maxFeePerBlobGas }\n              : {}),\n            ...(typeof maxFeePerGas !== 'undefined' ? { maxFeePerGas } : {}),\n            ...(typeof maxPriorityFeePerGas !== 'undefined'\n              ? { maxPriorityFeePerGas }\n              : {}),\n            ...('nonceKey' in rest && typeof rest.nonceKey !== 'undefined'\n              ? { nonceKey: rest.nonceKey }\n              : {}),\n          }\n        })\n        .catch((e) => {\n          const error = e as FillTransactionErrorType\n\n          if (error.name !== 'TransactionExecutionError') return request\n\n          const unsupported = error.walk?.((e) => {\n            const error = e as BaseError\n            return (\n              error.name === 'MethodNotFoundRpcError' ||\n              error.name === 'MethodNotSupportedRpcError'\n            )\n          })\n          if (unsupported) supportsFillTransaction.set(client.uid, false)\n\n          return request\n        })\n    : request\n\n  nonce ??= fillResult.nonce\n\n  request = {\n    ...(fillResult as any),\n    ...(account ? { from: account?.address } : {}),\n    ...(nonce ? { nonce } : {}),\n  }\n  const { blobs, gas, kzg, type } = request\n\n  if (\n    prepareTransactionRequest?.fn &&\n    prepareTransactionRequest.runAt?.includes('beforeFillParameters')\n  ) {\n    request = await prepareTransactionRequest.fn(\n      { ...request, chain },\n      {\n        phase: 'beforeFillParameters',\n      },\n    )\n  }\n\n  let block: Block | undefined\n  async function getBlock(): Promise<Block> {\n    if (block) return block\n    block = await getAction(\n      client,\n      getBlock_,\n      'getBlock',\n    )({ blockTag: 'latest' })\n    return block\n  }\n\n  if (\n    parameters.includes('nonce') &&\n    typeof nonce === 'undefined' &&\n    account &&\n    !nonceManager\n  )\n    request.nonce = await getAction(\n      client,\n      getTransactionCount,\n      'getTransactionCount',\n    )({\n      address: account.address,\n      blockTag: 'pending',\n    })\n\n  if (\n    (parameters.includes('blobVersionedHashes') ||\n      parameters.includes('sidecars')) &&\n    blobs &&\n    kzg\n  ) {\n    const commitments = blobsToCommitments({ blobs, kzg })\n\n    if (parameters.includes('blobVersionedHashes')) {\n      const versionedHashes = commitmentsToVersionedHashes({\n        commitments,\n        to: 'hex',\n      })\n      request.blobVersionedHashes = versionedHashes\n    }\n    if (parameters.includes('sidecars')) {\n      const proofs = blobsToProofs({ blobs, commitments, kzg })\n      const sidecars = toBlobSidecars({\n        blobs,\n        commitments,\n        proofs,\n        to: 'hex',\n      })\n      request.sidecars = sidecars\n    }\n  }\n\n  if (parameters.includes('chainId')) request.chainId = await getChainId()\n\n  if (\n    (parameters.includes('fees') || parameters.includes('type')) &&\n    typeof type === 'undefined'\n  ) {\n    try {\n      request.type = getTransactionType(\n        request as TransactionSerializable,\n      ) as any\n    } catch {\n      let isEip1559Network = eip1559NetworkCache.get(client.uid)\n      if (typeof isEip1559Network === 'undefined') {\n        const block = await getBlock()\n        isEip1559Network = typeof block?.baseFeePerGas === 'bigint'\n        eip1559NetworkCache.set(client.uid, isEip1559Network)\n      }\n      request.type = isEip1559Network ? 'eip1559' : 'legacy'\n    }\n  }\n\n  if (parameters.includes('fees')) {\n    // TODO(4844): derive blob base fees once https://github.com/ethereum/execution-apis/pull/486 is merged.\n\n    if (request.type !== 'legacy' && request.type !== 'eip2930') {\n      // EIP-1559 fees\n      if (\n        typeof request.maxFeePerGas === 'undefined' ||\n        typeof request.maxPriorityFeePerGas === 'undefined'\n      ) {\n        const block = await getBlock()\n        const { maxFeePerGas, maxPriorityFeePerGas } =\n          await internal_estimateFeesPerGas(client, {\n            block: block as Block,\n            chain,\n            request: request as PrepareTransactionRequestParameters,\n          })\n\n        if (\n          typeof request.maxPriorityFeePerGas === 'undefined' &&\n          request.maxFeePerGas &&\n          request.maxFeePerGas < maxPriorityFeePerGas\n        )\n          throw new MaxFeePerGasTooLowError({\n            maxPriorityFeePerGas,\n          })\n\n        request.maxPriorityFeePerGas = maxPriorityFeePerGas\n        request.maxFeePerGas = maxFeePerGas\n      }\n    } else {\n      // Legacy fees\n      if (\n        typeof request.maxFeePerGas !== 'undefined' ||\n        typeof request.maxPriorityFeePerGas !== 'undefined'\n      )\n        throw new Eip1559FeesNotSupportedError()\n\n      if (typeof request.gasPrice === 'undefined') {\n        const block = await getBlock()\n        const { gasPrice: gasPrice_ } = await internal_estimateFeesPerGas(\n          client,\n          {\n            block: block as Block,\n            chain,\n            request: request as PrepareTransactionRequestParameters,\n            type: 'legacy',\n          },\n        )\n        request.gasPrice = gasPrice_\n      }\n    }\n  }\n\n  if (parameters.includes('gas') && typeof gas === 'undefined')\n    request.gas = await getAction(\n      client,\n      estimateGas,\n      'estimateGas',\n    )({\n      ...request,\n      account,\n      prepare: account?.type === 'local' ? [] : ['blobVersionedHashes'],\n    } as EstimateGasParameters)\n\n  if (\n    prepareTransactionRequest?.fn &&\n    prepareTransactionRequest.runAt?.includes('afterFillParameters')\n  )\n    request = await prepareTransactionRequest.fn(\n      { ...request, chain },\n      {\n        phase: 'afterFillParameters',\n      },\n    )\n\n  assertRequest(request as AssertRequestParameters)\n\n  delete request.parameters\n\n  return request as any\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}